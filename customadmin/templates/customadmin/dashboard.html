{% extends 'customadmin/base.html'%}
{% load static %}
{% block d-active %}active {% endblock %}

{% block dashboard %}
<div class="card-body">
    <h4 class="card-title">Orders Chart</h4>
    <canvas id="orders-chart" class="chartjs-render-monitor"></canvas>
</div>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Get the canvas element
    var canvas = document.getElementById('orders-chart');
    var ctx = canvas.getContext('2d');

    // Fetch data from the backend
    fetch('{% url "orders_chart_data" %}')
        .then(response => response.json())
        .then(data => {
            var config = {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [
                        {
                            label: 'Monthly Orders',
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1,
                            data: data.monthly_orders,
                        },
                        {
                            label: 'Yearly Orders',
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1,
                            data: data.yearly_orders,
                        },
                        {
                            label: 'Daily Orders',
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1,
                            data: data.daily_orders,
                        }
                    ],
                },

                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Orders Chart',
                        },
                    },
                },
            };
            
            // Create the chart using the fetched data
            new Chart(ctx, config);
        })
        
        .catch(error => {
            console.error('Error fetching chart data:', error);
        });
</script>
{% endblock dashboard %}
